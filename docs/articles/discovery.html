<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discovery • qss</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">qss</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Discovery</h1>
            
          </div>

    
    
<div class="contents">
<div id="chapter-5-discovery" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#chapter-5-discovery" class="anchor"> </a></body></html>Chapter 5: Discovery</h1>
<div id="section-5-1-textual-data" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-5-1-textual-data" class="anchor"> </a></body></html>Section 5.1: Textual Data</h2>
<div id="section-5-1-1-the-disputed-authorship-of-the-federalist-papers" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-1-1-the-disputed-authorship-of-the-federalist-papers" class="anchor"> </a></body></html>Section 5.1.1: The Disputed Authorship of ‘The Federalist Papers’</h3>
<pre class="sourceCode r"><code class="sourceCode r">## load two required libraries
<span class="kw">library</span>(tm)</code></pre>
<pre><code>## Loading required package: NLP</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(SnowballC)

## load the raw corpus
corpus_dir &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/federalist/"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)
corpus.raw &lt;-<span class="st"> </span><span class="kw">Corpus</span>(<span class="kw">DirSource</span>(corpus_dir, <span class="dt">pattern =</span> <span class="st">"</span><span class="ch">\\</span><span class="st">.txt$"</span>))
corpus.raw</code></pre>
<pre><code>## &lt;&lt;VCorpus&gt;&gt;
## Metadata:  corpus specific: 0, document level (indexed): 0
## Content:  documents: 85</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## make lower case
corpus.prep &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corpus.raw, <span class="kw">content_transformer</span>(tolower))
## remove white space
corpus.prep &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corpus.prep, stripWhitespace)
## remove punctuation
corpus.prep &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corpus.prep, removePunctuation)

## remove numbers
corpus.prep &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corpus.prep, removeNumbers)

<span class="kw">head</span>(<span class="kw">stopwords</span>(<span class="st">"english"</span>))</code></pre>
<pre><code>## [1] "i"      "me"     "my"     "myself" "we"     "our"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## remove stop words
corpus &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corpus.prep, removeWords, <span class="kw">stopwords</span>(<span class="st">"english"</span>))

## finally stem remaining words
corpus &lt;-<span class="st"> </span><span class="kw">tm_map</span>(corpus, stemDocument)

## the output is truncated here to save space
<span class="kw">content</span>(corpus[[<span class="dv">10</span>]]) <span class="co"># Essay No. 10</span></code></pre>
<pre><code>##   [1] "among  numer advantag promis   wellconstruct union none"                                                      
##   [2] " deserv    accur develop   tendenc  break "                                                                   
##   [3] " control  violenc  faction  friend  popular govern never"                                                     
##   [4] " find   much alarm   charact  fate   "                                                                        
##   [5] " contempl  propens   danger vice  will  fail"                                                                 
##   [6] " therefor  set  due valu   plan  without violat "                                                             
##   [7] " principl     attach provid  proper cure   "                                                                  
##   [8] " instabl injustic  confus introduc   public council"                                                          
##   [9] "   truth   mortal diseas   popular govern"                                                                    
##  [10] "  everywher perish   continu    favorit  fruit"                                                               
##  [11] " topic    adversari  liberti deriv   specious"                                                                
##  [12] " declam  valuabl improv made   american constitut"                                                            
##  [13] "   popular model  ancient  modern  certain  "                                                                 
##  [14] " much admir      unwarrant partial  contend"                                                                  
##  [15] "     effectu obviat  danger   side  "                                                                         
##  [16] " wish  expect complaint  everywher heard    consider"                                                         
##  [17] "  virtuous citizen equal  friend  public  privat faith"                                                       
##  [18] "   public  person liberti   govern   unstabl"                                                                 
##  [19] "   public good  disregard   conflict  rival parti"                                                            
##  [20] "   measur   often decid  accord   rule "                                                                      
##  [21] " justic   right   minor parti    superior forc "                                                              
##  [22] "  interest  overbear major howev anxious  may wish"                                                           
##  [23] "   complaint   foundat  evid  known fact"                                                                     
##  [24] " will  permit us  deni      degre true  will"                                                                 
##  [25] "  found inde   candid review   situat    "                                                                    
##  [26] " distress    labor   erron charg   oper"                                                                      
##  [27] "   govern   will  found    time  "                                                                            
##  [28] " caus will  alon account  mani   heaviest misfortun "                                                         
##  [29] " particular   prevail  increas distrust  public engag"                                                        
##  [30] "  alarm  privat right   echo  one end   contin"                                                               
##  [31] "     must  chiefli   wholli effect   unsteadi"                                                                
##  [32] "  injustic    factious spirit  taint  public administr   faction  understand  number  citizen whether amount "
##  [33] "  major   minor   whole   unit  actuat "                                                                      
##  [34] "  common impuls  passion   interest advers   right"                                                           
##  [35] "   citizen    perman  aggreg interest  "                                                                      
##  [36] " communiti   two method  cure  mischief  faction  one "                                                       
##  [37] " remov  caus    control  effect    two method  remov  caus  faction  one"                                     
##  [38] "  destroy  liberti   essenti   exist  "                                                                       
##  [39] "  give  everi citizen   opinion   passion  "                                                                  
##  [40] "  interest   never   truli said    first remedi   "                                                           
##  [41] " wors   diseas liberti   faction  air   fire "                                                                
##  [42] " aliment without   instant expir      less folli"                                                             
##  [43] "  abolish liberti   essenti  polit life   nourish"                                                            
##  [44] " faction      wish  annihil  air   essenti"                                                                   
##  [45] "  anim life   impart  fire  destruct agenc  second expedi   impractic   first   unwis"                        
##  [46] "  long   reason  man continu fallibl     liberti"                                                             
##  [47] "  exercis  differ opinion will  form  long   connect"                                                         
##  [48] " subsist   reason   selflov  opinion   passion"                                                               
##  [49] " will   reciproc influenc      former will "                                                                  
##  [50] " object    latter will attach   divers  "                                                                     
##  [51] " faculti  men    right  properti origin  "                                                                    
##  [52] " less  insuper obstacl   uniform  interest  protect"                                                          
##  [53] "   faculti   first object  govern   protect"                                                                  
##  [54] "  differ  unequ faculti  acquir properti  possess"                                                            
##  [55] "  differ degre  kind  properti immedi result  "                                                               
##  [56] "  influenc     sentiment  view   respect proprietor"                                                          
##  [57] " ensu  divis   societi  differ interest  parti  latent caus  faction  thus sown   natur  man "                
##  [58] "  see  everywher brought  differ degre  activ accord"                                                         
##  [59] "   differ circumst  civil societi  zeal  differ"                                                              
##  [60] " opinion concern religion concern govern  mani  point"                                                        
##  [61] "  well  specul   practic  attach  differ leader"                                                              
##  [62] " ambiti contend  preemin  power   person  "                                                                   
##  [63] " descript whose fortun   interest   human passion"                                                            
##  [64] "   turn divid mankind  parti inflam   mutual"                                                                 
##  [65] " animos  render  much  dispos  vex  oppress "                                                                 
##  [66] "    cooper   common good  strong   propens"                                                                   
##  [67] "  mankind  fall  mutual animos    substanti"                                                                  
##  [68] " occas present    frivol  fanci distinct"                                                                     
##  [69] "   suffici  kindl  unfriend passion  excit "                                                                  
##  [70] "  violent conflict    common  durabl sourc  faction"                                                          
##  [71] "    various  unequ distribut  properti   hold"                                                                
##  [72] "     without properti  ever form distinct interest"                                                           
##  [73] "  societi    creditor     debtor fall "                                                                       
##  [74] "  like discrimin  land interest  manufactur interest "                                                        
##  [75] " mercantil interest  money interest  mani lesser interest grow"                                               
##  [76] "   necess  civil nation  divid   differ class"                                                                
##  [77] " actuat  differ sentiment  view  regul   various"                                                             
##  [78] "  interf interest form  princip task  modern legisl"                                                          
##  [79] "  involv  spirit  parti  faction   necessari  ordinari"                                                       
##  [80] " oper   govern  man  allow    judg    caus   interest"                                                        
##  [81] "  certain bias  judgment   improb corrupt  integr"                                                            
##  [82] "  equal nay  greater reason  bodi  men  unfit   "                                                             
##  [83] " judg  parti    time yet   mani    import"                                                                    
##  [84] " act  legisl   mani judici determin  inde concern"                                                            
##  [85] "  right  singl person  concern  right  larg bodi"                                                             
##  [86] "  citizen     differ class  legisl  advoc"                                                                    
##  [87] "  parti   caus   determin   law propos concern"                                                               
##  [88] " privat debt    question    creditor  parti "                                                                 
##  [89] " one side   debtor    justic   hold  balanc"                                                                  
##  [90] "   yet  parti   must    judg"                                                                                 
##  [91] "    numer parti    word   power faction"                                                                      
##  [92] " must  expect  prevail shall domest manufactur  encourag"                                                     
##  [93] "    degre  restrict  foreign manufactur  question"                                                            
##  [94] "    differ decid   land   manufactur"                                                                         
##  [95] " class  probabl  neither   sole regard  justic  "                                                             
##  [96] " public good  apportion  tax   various descript "                                                             
##  [97] " properti   act  seem  requir   exact imparti"                                                                
##  [98] " yet   perhap  legisl act   greater opportun"                                                                 
##  [99] "  temptat  given   predomin parti  trampl   rule"                                                             
## [100] "  justic everi shill    overburden  inferior number"                                                          
## [101] "   shill save    pocket    vain  say  enlighten statesmen will  abl  adjust"                                  
## [102] "  clash interest  render   subservi   public"                                                                 
## [103] " good enlighten statesmen will  alway    helm   mani"                                                         
## [104] " case can   adjust  made   without take  view"                                                                
## [105] " indirect  remot consider  will rare prevail  "                                                               
## [106] " immedi interest  one parti may find  disregard  right"                                                       
## [107] "  anoth   good   whole  infer     brought    caus  faction"                                                   
## [108] "   remov   relief     sought   mean "                                                                         
## [109] " control  effect   faction consist  less   major relief  suppli "                                             
## [110] "  republican principl  enabl  major  defeat  sinist"                                                          
## [111] " view  regular vote  may clog  administr  may convuls"                                                        
## [112] "  societi   will  unabl  execut  mask  violenc "                                                              
## [113] "  form   constitut   major  includ   faction"                                                                 
## [114] "  form  popular govern    hand enabl   sacrific"                                                              
## [115] "   rule passion  interest   public good   right"                                                              
## [116] "   citizen  secur  public good  privat right "                                                                
## [117] "  danger    faction     time  preserv  spirit"                                                                
## [118] "   form  popular govern    great object  "                                                                    
## [119] "  inquiri  direct let  add     great desideratum"                                                             
## [120] "    form  govern can  rescu   opprobrium "                                                                    
## [121] "     long labor   recommend   esteem  adopt"                                                                  
## [122] "  mankind   mean   object attain evid  one  two "                                                             
## [123] " either  exist    passion  interest   major "                                                                 
## [124] "   time must  prevent   major   coexist"                                                                      
## [125] " passion  interest must  render   number  local situat"                                                       
## [126] " unabl  concert  carri  effect scheme  oppress  "                                                             
## [127] " impuls   opportun  suffer  coincid  well know "                                                              
## [128] " neither moral  religi motiv can  reli    adequ control"                                                      
## [129] "    found      injustic  violenc  individu"                                                                   
## [130] "  lose  efficaci  proport   number combin togeth"                                                             
## [131] "    proport   efficaci becom need   view   subject  may  conclud   pure democraci"                            
## [132] "    mean  societi consist   small number  citizen "                                                           
## [133] " assembl  administ  govern  person can admit   cure"                                                          
## [134] "   mischief  faction  common passion  interest will  almost"                                                  
## [135] " everi case  felt   major   whole  communic  concert"                                                         
## [136] " result   form  govern     noth  check"                                                                       
## [137] "  induc  sacrific  weaker parti   obnoxi individu"                                                            
## [138] " henc     democraci  ever  spectacl  turbul"                                                                  
## [139] "  content  ever  found incompat  person secur"                                                                
## [140] "   right  properti    general   short  "                                                                      
## [141] " live     violent   death theoret politician"                                                                 
## [142] "   patron  speci  govern  erron suppos"                                                                       
## [143] "   reduc mankind   perfect equal   polit right"                                                               
## [144] "      time  perfect equal  assimil "                                                                          
## [145] "  possess  opinion   passion  republ    mean  govern    scheme  represent"                                    
## [146] " take place open  differ prospect  promis  cure  "                                                            
## [147] "   seek let us examin  point    vari  pure"                                                                   
## [148] " democraci   shall comprehend   natur   cure  "                                                               
## [149] " efficaci   must deriv   union  two great point  differ   democraci   republ"                                 
## [150] "  first  deleg   govern   latter   small"                                                                     
## [151] " number  citizen elect   rest second  greater number "                                                        
## [152] " citizen  greater sphere  countri    latter may "                                                             
## [153] " extend  effect   first differ    one hand  refin "                                                           
## [154] " enlarg  public view  pass    medium   chosen"                                                                
## [155] " bodi  citizen whose wisdom may best discern  true interest  "                                                
## [156] " countri  whose patriot  love  justic will  least like"                                                       
## [157] "  sacrific   temporari  partial consider    regul"                                                            
## [158] "  may well happen   public voic pronounc   repres"                                                            
## [159] "   peopl will   conson   public good   pronounc"                                                              
## [160] "   peopl  conven   purpos    hand"                                                                            
## [161] "  effect may  invert men  factious temper  local prejudic"                                                    
## [162] "   sinist design may  intrigu  corrupt    mean"                                                               
## [163] " first obtain  suffrag   betray  interest   peopl"                                                            
## [164] "  question result  whether small  extens republ  "                                                            
## [165] " favor   elect  proper guardian   public weal "                                                               
## [166] "   clear decid  favor   latter  two obvious consider   first place     remark  howev small  republ"           
## [167] " may   repres must  rais   certain number  order"                                                             
## [168] "  guard   cabal      howev larg  may "                                                                        
## [169] "  must  limit   certain number  order  guard  "                                                               
## [170] " confus   multitud henc  number  repres  "                                                                    
## [171] " two case    proport     two constitu "                                                                       
## [172] "  proport greater   small republ  follow  "                                                                   
## [173] "  proport  fit charact   less   larg   "                                                                      
## [174] " small republ  former will present  greater option  consequ"                                                  
## [175] "  greater probabl   fit choic   next place   repres will  chosen   greater"                                   
## [176] " number  citizen   larg    small republ  will "                                                               
## [177] "  difficult  unworthi candid  practic  success  vicious"                                                      
## [178] " art   elect   often carri   suffrag  "                                                                       
## [179] " peopl   free will   like  centr  men  possess"                                                               
## [180] "   attract merit    diffus  establish charact  must  confess        case   "                                  
## [181] " mean   side   inconveni will  found  lie  enlarg"                                                            
## [182] "  much  number  elector  render  repres  littl"                                                               
## [183] " acquaint    local circumst  lesser interest "                                                                
## [184] "  reduc   much  render  unduli attach   "                                                                     
## [185] "  littl fit  comprehend  pursu great  nation object "                                                         
## [186] " feder constitut form  happi combin   respect  great"                                                         
## [187] "  aggreg interest  refer   nation  local "                                                                    
## [188] " particular   state legislatur   point  differ   greater number  citizen "                                    
## [189] " extent  territori  may  brought within  compass  republican"                                                 
## [190] "   democrat govern     circumst princip"                                                                      
## [191] "  render factious combin less   dread   former "                                                              
## [192] "   latter  smaller  societi  fewer probabl will  "                                                            
## [193] " distinct parti  interest compos   fewer  distinct parti"                                                     
## [194] "  interest   frequent will  major  found   "                                                                  
## [195] " parti   smaller  number  individu compos  major"                                                             
## [196] "   smaller  compass within    place   easili"                                                                 
## [197] " will  concert  execut  plan  oppress extend  sphere"                                                         
## [198] "   take   greater varieti  parti  interest  make "                                                            
## [199] " less probabl   major   whole will   common motiv "                                                           
## [200] " invad  right   citizen     common motiv exist"                                                               
## [201] "  will   difficult    feel   discov   strength"                                                               
## [202] "   act  unison    besid  impedi  may"                                                                         
## [203] "  remark      conscious  unjust  dishonor"                                                                    
## [204] " purpos communic  alway check  distrust  proport "                                                            
## [205] "  number whose concurr  necessari henc  clear appear    advantag   republ "                                   
## [206] "   democraci  control  effect  faction  enjoy "                                                               
## [207] "  larg   small republici enjoy   union   state"                                                               
## [208] " compos    advantag consist   substitut  repres"                                                              
## [209] " whose enlighten view  virtuous sentiment render  superior "                                                  
## [210] " local prejudic  scheme  injustic  will   deni "                                                              
## [211] "  represent   union will   like  possess  requisit"                                                           
## [212] " endow   consist   greater secur afford   greater"                                                            
## [213] " varieti  parti   event   one parti  abl  outnumb"                                                            
## [214] "  oppress  rest   equal degre   increas varieti "                                                             
## [215] " parti compris within  union increas  secur   "                                                               
## [216] " fine consist   greater obstacl oppos   concert  accomplish"                                                  
## [217] "   secret wish   unjust  interest major  "                                                                    
## [218] "  extent   union give    palpabl advantag  influenc  factious leader may kindl  flame within  particular"     
## [219] " state  will  unabl  spread  general conflagr  "                                                              
## [220] "  state  religi sect may degener   polit faction"                                                             
## [221] "   part   confederaci   varieti  sect dispers "                                                               
## [222] "  entir face   must secur  nation council   danger"                                                           
## [223] "   sourc  rage  paper money   abolit  debt "                                                                  
## [224] "  equal divis  properti     improp  wick project"                                                             
## [225] " will  less apt  pervad  whole bodi   union   particular"                                                     
## [226] " member      proport    maladi   like "                                                                       
## [227] " taint  particular counti  district   entir state   extent  proper structur   union therefor  behold"         
## [228] "  republican remedi   diseas  incid  republican govern"                                                       
## [229] "  accord   degre  pleasur  pride  feel   republican"                                                          
## [230] "     zeal  cherish  spirit  support  charact"                                                                 
## [231] "  federalist"</code></pre>
</div>
<div id="section-5-1-2-document-term-matrix" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-1-2-document-term-matrix" class="anchor"> </a></body></html>Section 5.1.2: Document-Term Matrix</h3>
<pre class="sourceCode r"><code class="sourceCode r">dtm &lt;-<span class="st"> </span><span class="kw">DocumentTermMatrix</span>(corpus)
dtm</code></pre>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 85, terms: 4849)&gt;&gt;
## Non-/sparse entries: 44917/367248
## Sparsity           : 89%
## Maximal term length: 18
## Weighting          : term frequency (tf)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">inspect</span>(dtm[<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">1</span>:<span class="dv">8</span>])</code></pre>
<pre><code>## &lt;&lt;DocumentTermMatrix (documents: 5, terms: 8)&gt;&gt;
## Non-/sparse entries: 4/36
## Sparsity           : 90%
## Maximal term length: 7
## Weighting          : term frequency (tf)
## 
##           Terms
## Docs       abandon abat abb abet abhorr abil abject abl
##   fp01.txt       0    0   0    0      0    0      0   1
##   fp02.txt       0    0   0    0      0    1      0   0
##   fp03.txt       0    0   0    0      0    0      0   2
##   fp04.txt       0    0   0    0      0    0      0   1
##   fp05.txt       0    0   0    0      0    0      0   0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">dtm.mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(dtm)</code></pre>
</div>
<div id="section-5-1-3-topic-discovery" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-1-3-topic-discovery" class="anchor"> </a></body></html>Section 5.1.3: Topic Discovery</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wordcloud)</code></pre>
<pre><code>## Loading required package: RColorBrewer</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wordcloud</span>(<span class="kw">colnames</span>(dtm.mat), dtm.mat[<span class="dv">12</span>, ], <span class="dt">max.words =</span> <span class="dv">20</span>)  <span class="co"># essay No. 12</span></code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">wordcloud</span>(<span class="kw">colnames</span>(dtm.mat), dtm.mat[<span class="dv">24</span>, ], <span class="dt">max.words =</span> <span class="dv">20</span>)  <span class="co"># essay No. 24</span></code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-3-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stemCompletion</span>(<span class="kw">c</span>(<span class="st">"revenu"</span>, <span class="st">"commerc"</span>, <span class="st">"peac"</span>, <span class="st">"army"</span>), corpus.prep)</code></pre>
<pre><code>##     revenu    commerc       peac       army 
##  "revenue" "commerce"    "peace"     "army"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">dtm.tfidf &lt;-<span class="st"> </span><span class="kw">weightTfIdf</span>(dtm) <span class="co"># tf-idf calculation</span>

dtm.tfidf.mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(dtm.tfidf)  <span class="co"># convert to matrix</span>

## 10 most important words for Paper No. 12
<span class="kw">head</span>(<span class="kw">sort</span>(dtm.tfidf.mat[<span class="dv">12</span>, ], <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="dv">10</span>)</code></pre>
<pre><code>##     revenu contraband     patrol      excis      coast      trade 
## 0.01905877 0.01886965 0.01886965 0.01876560 0.01592559 0.01473504 
##        per        tax       cent     gallon 
## 0.01420342 0.01295466 0.01257977 0.01257977</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## 10 most important words for Paper No. 24
<span class="kw">head</span>(<span class="kw">sort</span>(dtm.tfidf.mat[<span class="dv">24</span>, ], <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="dv">10</span>)</code></pre>
<pre><code>##   garrison   dockyard settlement      spain       armi   frontier 
## 0.02965511 0.01962294 0.01962294 0.01649040 0.01544256 0.01482756 
##    arsenal    western       post     nearer 
## 0.01308196 0.01306664 0.01236780 0.01166730</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">k &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co"># number of clusters</span>
## subset The Federalist papers written by Hamilton
hamilton &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>:<span class="dv">9</span>, <span class="dv">11</span>:<span class="dv">13</span>, <span class="dv">15</span>:<span class="dv">17</span>, <span class="dv">21</span>:<span class="dv">36</span>, <span class="dv">59</span>:<span class="dv">61</span>, <span class="dv">65</span>:<span class="dv">85</span>)
dtm.tfidf.hamilton &lt;-<span class="st"> </span>dtm.tfidf.mat[hamilton, ]

## run k-means
km.out &lt;-<span class="st"> </span><span class="kw">kmeans</span>(dtm.tfidf.hamilton, <span class="dt">centers =</span> k)
km.out$iter <span class="co"># check the convergence; number of iterations may vary</span></code></pre>
<pre><code>## [1] 4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## label each centroid with the corresponding term
<span class="kw">colnames</span>(km.out$centers) &lt;-<span class="st"> </span><span class="kw">colnames</span>(dtm.tfidf.hamilton)

for (i in <span class="dv">1</span>:k) { <span class="co"># loop for each cluster</span>
    <span class="kw">cat</span>(<span class="st">"CLUSTER"</span>, i, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
    <span class="kw">cat</span>(<span class="st">"Top 10 words:</span><span class="ch">\n</span><span class="st">"</span>) <span class="co"># 10 most important terms at the centroid</span>
    <span class="kw">print</span>(<span class="kw">head</span>(<span class="kw">sort</span>(km.out$centers[i, ], <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="dv">10</span>))
    <span class="kw">cat</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
    <span class="kw">cat</span>(<span class="st">"Federalist Papers classified: </span><span class="ch">\n</span><span class="st">"</span>) <span class="co"># extract essays classified</span>
    <span class="kw">print</span>(<span class="kw">rownames</span>(dtm.tfidf.hamilton)[km.out$cluster ==<span class="st"> </span>i])
    <span class="kw">cat</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)
}</code></pre>
<pre><code>## CLUSTER 1 
## Top 10 words:
##       court       senat        upon        juri      presid       claus 
## 0.006979236 0.004317092 0.003983231 0.003385189 0.002751280 0.002750835 
##   jurisdict       offic         tax     impeach 
## 0.002649711 0.002566185 0.002526463 0.002294396 
## 
## Federalist Papers classified: 
##  [1] "fp01.txt" "fp06.txt" "fp07.txt" "fp09.txt" "fp15.txt" "fp16.txt"
##  [7] "fp17.txt" "fp21.txt" "fp22.txt" "fp23.txt" "fp27.txt" "fp30.txt"
## [13] "fp31.txt" "fp32.txt" "fp33.txt" "fp34.txt" "fp36.txt" "fp59.txt"
## [19] "fp60.txt" "fp61.txt" "fp65.txt" "fp66.txt" "fp68.txt" "fp70.txt"
## [25] "fp71.txt" "fp72.txt" "fp73.txt" "fp75.txt" "fp76.txt" "fp77.txt"
## [31] "fp78.txt" "fp79.txt" "fp80.txt" "fp81.txt" "fp82.txt" "fp83.txt"
## [37] "fp84.txt" "fp85.txt"
## 
## CLUSTER 2 
## Top 10 words:
##       trade    merchant    northern       navig  manufactur      revenu 
## 0.013962253 0.012890018 0.010487956 0.010283154 0.009795735 0.009754859 
##     commerc    southern      market confederaci 
## 0.009501991 0.009303222 0.009179588 0.006984902 
## 
## Federalist Papers classified: 
## [1] "fp11.txt" "fp12.txt" "fp13.txt" "fp35.txt"
## 
## CLUSTER 3 
## Top 10 words:
##     militia        armi    militari      pardon    governor     treason 
## 0.014639288 0.014493183 0.010024167 0.007643664 0.007114050 0.005833538 
##   disciplin        peac      presid    garrison 
## 0.005567509 0.005053636 0.004940856 0.004717510 
## 
## Federalist Papers classified: 
## [1] "fp08.txt" "fp24.txt" "fp25.txt" "fp26.txt" "fp28.txt" "fp29.txt"
## [7] "fp69.txt" "fp74.txt"
## 
## CLUSTER 4 
## Top 10 words:
##     vacanc     recess      claus      senat    session       fill 
## 0.06953047 0.04437713 0.04082617 0.03408008 0.03313305 0.03101140 
##    appoint     presid      expir    unfound 
## 0.02211662 0.01852025 0.01738262 0.01684465 
## 
## Federalist Papers classified: 
## [1] "fp67.txt"</code></pre>
</div>
<div id="section-5-1-4-authorship-prediction" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-1-4-authorship-prediction" class="anchor"> </a></body></html>Section 5.1.4: Authorship Prediction</h3>
<pre class="sourceCode r"><code class="sourceCode r">## document-term matrix converted to matrix for manipulation
dtm1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">DocumentTermMatrix</span>(corpus.prep))
tfm &lt;-<span class="st"> </span>dtm1 /<span class="st"> </span><span class="kw">rowSums</span>(dtm1) *<span class="st"> </span><span class="dv">1000</span> <span class="co"># term frequency per 1000 words</span>

## words of interest
words &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"although"</span>, <span class="st">"always"</span>, <span class="st">"commonly"</span>, <span class="st">"consequently"</span>,
           <span class="st">"considerable"</span>, <span class="st">"enough"</span>, <span class="st">"there"</span>, <span class="st">"upon"</span>, <span class="st">"while"</span>, <span class="st">"whilst"</span>)

## select only these words
tfm &lt;-<span class="st"> </span>tfm[, words]

## essays written by Madison: `hamilton' defined earlier
madison &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">14</span>, <span class="dv">37</span>:<span class="dv">48</span>, <span class="dv">58</span>)

## average among Hamilton/Madison essays
tfm.ave &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">colSums</span>(tfm[hamilton, ]) /<span class="st"> </span><span class="kw">length</span>(hamilton),
                 <span class="kw">colSums</span>(tfm[madison, ]) /<span class="st"> </span><span class="kw">length</span>(madison))
tfm.ave</code></pre>
<table class="table">
<thead><tr class="header">
<th align="right">although</th>
<th align="right">always</th>
<th align="right">commonly</th>
<th align="right">consequently</th>
<th align="right">considerable</th>
<th align="right">enough</th>
<th align="right">there</th>
<th align="right">upon</th>
<th align="right">while</th>
<th align="right">whilst</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0175698</td>
<td align="right">0.7527744</td>
<td align="right">0.2630876</td>
<td align="right">0.0260086</td>
<td align="right">0.5435127</td>
<td align="right">0.3955031</td>
<td align="right">4.417750</td>
<td align="right">4.3986828</td>
<td align="right">0.3700484</td>
<td align="right">0.0070557</td>
</tr>
<tr class="even">
<td align="right">0.2705881</td>
<td align="right">0.2006710</td>
<td align="right">0.0000000</td>
<td align="right">0.4487847</td>
<td align="right">0.1601669</td>
<td align="right">0.0000000</td>
<td align="right">1.113252</td>
<td align="right">0.2000269</td>
<td align="right">0.0000000</td>
<td align="right">0.3801131</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">author &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">nrow</span>(dtm1)) <span class="co"># a vector with missing values</span>
author[hamilton] &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># 1 if Hamilton</span>
author[madison] &lt;-<span class="st"> </span>-<span class="dv">1</span>  <span class="co"># -1 if Madison</span>

## data frame for regression
author.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">author =</span> author[<span class="kw">c</span>(hamilton, madison)],
                          tfm[<span class="kw">c</span>(hamilton, madison), ])

hm.fit &lt;-<span class="st"> </span><span class="kw">lm</span>(author ~<span class="st"> </span>upon +<span class="st"> </span>there +<span class="st"> </span>consequently +<span class="st"> </span>whilst,
             <span class="dt">data =</span> author.data)
hm.fit</code></pre>
<pre><code>## 
## Call:
## lm(formula = author ~ upon + there + consequently + whilst, data = author.data)
## 
## Coefficients:
##  (Intercept)          upon         there  consequently        whilst  
##     -0.26288       0.16678       0.09494      -0.44012      -0.65875</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">hm.fitted &lt;-<span class="st"> </span><span class="kw">fitted</span>(hm.fit) <span class="co"># fitted values</span>
<span class="kw">sd</span>(hm.fitted)</code></pre>
<pre><code>## [1] 0.7180769</code></pre>
</div>
<div id="section-5-1-5-cross-validation" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-1-5-cross-validation" class="anchor"> </a></body></html>Section 5.1.5: Cross-Validation</h3>
<pre class="sourceCode r"><code class="sourceCode r">## proportion of correctly classified essays by Hamilton
<span class="kw">mean</span>(hm.fitted[author.data$author ==<span class="st"> </span><span class="dv">1</span>] &gt;<span class="st"> </span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## proportion of correctly classified essays by Madison
<span class="kw">mean</span>(hm.fitted[author.data$author ==<span class="st"> </span>-<span class="dv">1</span>] &lt;<span class="st"> </span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(author.data)
hm.classify &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n) <span class="co"># a container vector with missing values</span>

for (i in <span class="dv">1</span>:n) {
    ## fit the model to the data after removing the ith observation
    sub.fit &lt;-<span class="st"> </span><span class="kw">lm</span>(author ~<span class="st"> </span>upon +<span class="st"> </span>there +<span class="st"> </span>consequently +<span class="st"> </span>whilst,
                  <span class="dt">data =</span> author.data[-i, ]) <span class="co"># exclude ith row</span>
    ## predict the authorship for the ith observation
    hm.classify[i] &lt;-<span class="st"> </span><span class="kw">predict</span>(sub.fit, <span class="dt">newdata =</span> author.data[i, ])
}

## proportion of correctly classified essays by Hamilton
<span class="kw">mean</span>(hm.classify[author.data$author ==<span class="st"> </span><span class="dv">1</span>] &gt;<span class="st"> </span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## proportion of correctly classified essays by Madison
<span class="kw">mean</span>(hm.classify[author.data$author ==<span class="st"> </span>-<span class="dv">1</span>] &lt;<span class="st"> </span><span class="dv">0</span>)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">disputed &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">49</span>, <span class="dv">50</span>:<span class="dv">57</span>, <span class="dv">62</span>, <span class="dv">63</span>) <span class="co"># 11 essays with disputed authorship</span>
tf.disputed &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(tfm[disputed, ])

## prediction of disputed authorship
pred &lt;-<span class="st"> </span><span class="kw">predict</span>(hm.fit, <span class="dt">newdata =</span> tf.disputed)
pred <span class="co"># predicted values</span></code></pre>
<pre><code>##    fp49.txt    fp50.txt    fp51.txt    fp52.txt    fp53.txt    fp54.txt 
## -0.99831799 -0.06759254 -1.53243206 -0.26288400 -0.54584900 -0.56566555 
##    fp55.txt    fp56.txt    fp57.txt    fp62.txt    fp63.txt 
##  0.04376632 -0.57115610 -1.22289415 -1.00675456 -0.21939646</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
## fitted values for essays authored by Hamilton; red squares
<span class="kw">plot</span>(hamilton, hm.fitted[author.data$author ==<span class="st"> </span><span class="dv">1</span>], <span class="dt">pch =</span> <span class="dv">15</span>,
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">85</span>), <span class="dt">ylim  =</span> <span class="kw">c</span>(-<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">col =</span> <span class="st">"red"</span>,
     <span class="dt">xlab =</span> <span class="st">"Federalist Papers"</span>, <span class="dt">ylab =</span> <span class="st">"Predicted values"</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="st">"dashed"</span>)

## essays authored by Madison; blue circles
<span class="kw">points</span>(madison, hm.fitted[author.data$author ==<span class="st"> </span>-<span class="dv">1</span>],
       <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">"blue"</span>)

## disputed authorship; black triangles
<span class="kw">points</span>(disputed, pred, <span class="dt">pch =</span> <span class="dv">17</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
</div>
<div id="section-5-2-network-data" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-5-2-network-data" class="anchor"> </a></body></html>Section 5.2: Network Data</h2>
<div id="section-5-2-1-marriage-network-in-renaissance-florence" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-2-1-marriage-network-in-renaissance-florence" class="anchor"> </a></body></html>Section 5.2.1: Marriage Network in Renaissance Florence</h3>
<pre class="sourceCode r"><code class="sourceCode r">## the first column "FAMILY" of the CSV file represents row names
<span class="kw">data</span>(<span class="st">"florentine"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)
florence &lt;-<span class="st"> </span><span class="kw">data.frame</span>(florentine, <span class="dt">row.names =</span> <span class="st">"FAMILY"</span>)

## print out the adjacency (sub)matrix for the first 5 families
florence[<span class="dv">1</span>:<span class="dv">5</span>, <span class="dv">1</span>:<span class="dv">5</span>]</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">ACCIAIUOL</th>
<th align="right">ALBIZZI</th>
<th align="right">BARBADORI</th>
<th align="right">BISCHERI</th>
<th align="right">CASTELLAN</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ACCIAIUOL</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ALBIZZI</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">BARBADORI</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">BISCHERI</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">CASTELLAN</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowSums</span>(florence)</code></pre>
<pre><code>## ACCIAIUOL   ALBIZZI BARBADORI  BISCHERI CASTELLAN    GINORI  GUADAGNI 
##         1         3         2         3         3         1         4 
## LAMBERTES    MEDICI     PAZZI   PERUZZI     PUCCI   RIDOLFI  SALVIATI 
##         1         6         1         3         0         3         2 
##   STROZZI TORNABUON 
##         4         3</code></pre>
</div>
<div id="section-5-2-2-undirected-graph-and-centrality-measures" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-2-2-undirected-graph-and-centrality-measures" class="anchor"> </a></body></html>Section 5.2.2: Undirected Graph and Centrality Measures</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)

<span class="kw">library</span>(<span class="st">"igraph"</span>)  <span class="co"># load the package</span></code></pre>
<pre><code>## 
## Attaching package: 'igraph'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     union</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">florence &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(florence) <span class="co"># coerce into a matrix</span>
florence &lt;-<span class="st"> </span><span class="kw">graph.adjacency</span>(florence, <span class="dt">mode =</span> <span class="st">"undirected"</span>, <span class="dt">diag =</span> <span class="ot">FALSE</span>)

<span class="kw">plot</span>(florence) <span class="co"># plot the graph</span></code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">degree</span>(florence)</code></pre>
<pre><code>## ACCIAIUOL   ALBIZZI BARBADORI  BISCHERI CASTELLAN    GINORI  GUADAGNI 
##         1         3         2         3         3         1         4 
## LAMBERTES    MEDICI     PAZZI   PERUZZI     PUCCI   RIDOLFI  SALVIATI 
##         1         6         1         3         0         3         2 
##   STROZZI TORNABUON 
##         4         3</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">closeness</span>(florence)</code></pre>
<pre><code>##   ACCIAIUOL     ALBIZZI   BARBADORI    BISCHERI   CASTELLAN      GINORI 
## 0.018518519 0.022222222 0.020833333 0.019607843 0.019230769 0.017241379 
##    GUADAGNI   LAMBERTES      MEDICI       PAZZI     PERUZZI       PUCCI 
## 0.021739130 0.016949153 0.024390244 0.015384615 0.018518519 0.004166667 
##     RIDOLFI    SALVIATI     STROZZI   TORNABUON 
## 0.022727273 0.019230769 0.020833333 0.022222222</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">1</span> /<span class="st"> </span>(<span class="kw">closeness</span>(florence) *<span class="st"> </span><span class="dv">15</span>)</code></pre>
<pre><code>## ACCIAIUOL   ALBIZZI BARBADORI  BISCHERI CASTELLAN    GINORI  GUADAGNI 
##  3.600000  3.000000  3.200000  3.400000  3.466667  3.866667  3.066667 
## LAMBERTES    MEDICI     PAZZI   PERUZZI     PUCCI   RIDOLFI  SALVIATI 
##  3.933333  2.733333  4.333333  3.600000 16.000000  2.933333  3.466667 
##   STROZZI TORNABUON 
##  3.200000  3.000000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">betweenness</span>(florence)</code></pre>
<pre><code>## ACCIAIUOL   ALBIZZI BARBADORI  BISCHERI CASTELLAN    GINORI  GUADAGNI 
##  0.000000 19.333333  8.500000  9.500000  5.000000  0.000000 23.166667 
## LAMBERTES    MEDICI     PAZZI   PERUZZI     PUCCI   RIDOLFI  SALVIATI 
##  0.000000 47.500000  0.000000  2.000000  0.000000 10.333333 13.000000 
##   STROZZI TORNABUON 
##  9.333333  8.333333</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
<span class="kw">plot</span>(florence, <span class="dt">vertex.size =</span> <span class="kw">closeness</span>(florence) *<span class="st"> </span><span class="dv">1000</span>,
     <span class="dt">main =</span> <span class="st">"Closeness"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-7-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(florence, <span class="dt">vertex.size =</span> <span class="kw">betweenness</span>(florence),
     <span class="dt">main =</span> <span class="st">"Betweenness"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-7-3.png" width="672"></p>
</div>
<div id="section-5-2-3-twitter-following-network" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-2-3-twitter-following-network" class="anchor"> </a></body></html>Section 5.2.3: Twitter-Following Network</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"twitter.following"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)
<span class="kw">data</span>(<span class="st">"twitter.senator"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)

n &lt;-<span class="st"> </span><span class="kw">nrow</span>(twitter.senator) <span class="co"># number of senators</span>

## initialize adjacency matrix
twitter.adj &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> n)

## assign screen names to rows and columns
<span class="kw">colnames</span>(twitter.adj) &lt;-<span class="st"> </span><span class="kw">rownames</span>(twitter.adj) &lt;-<span class="st"> </span>twitter.senator$screen_name

## change `0' to `1' when edge goes from node `i' to node `j'
for (i in <span class="dv">1</span>:<span class="kw">nrow</span>(twitter.adj)) {
    twitter.adj[twitter.following$following[i], twitter.following$followed[i]] &lt;-<span class="st"> </span><span class="dv">1</span>
}

twitter.adj &lt;-<span class="st"> </span><span class="kw">graph.adjacency</span>(twitter.adj, <span class="dt">mode =</span> <span class="st">"directed"</span>, <span class="dt">diag =</span> <span class="ot">FALSE</span>)</code></pre>
</div>
<div id="section-5-2-4-directed-graph-and-centrality" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-2-4-directed-graph-and-centrality" class="anchor"> </a></body></html>Section 5.2.4: Directed Graph and Centrality</h3>
<pre class="sourceCode r"><code class="sourceCode r">twitter.senator$indegree &lt;-<span class="st"> </span><span class="kw">degree</span>(twitter.adj, <span class="dt">mode =</span> <span class="st">"in"</span>)
twitter.senator$outdegree &lt;-<span class="st"> </span><span class="kw">degree</span>(twitter.adj, <span class="dt">mode =</span> <span class="st">"out"</span>)

in.order &lt;-<span class="st"> </span><span class="kw">order</span>(twitter.senator$indegree, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)
out.order &lt;-<span class="st"> </span><span class="kw">order</span>(twitter.senator$outdegree, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)

## 3 greatest indegree
twitter.senator[in.order[<span class="dv">1</span>:<span class="dv">3</span>], ]</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">screen_name</th>
<th align="left">name</th>
<th align="left">party</th>
<th align="left">state</th>
<th align="right">indegree</th>
<th align="right">outdegree</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">5</td>
<td align="left">SenatorBurr</td>
<td align="left">Richard Burr</td>
<td align="left">R</td>
<td align="left">NC</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="left">JohnBoozman</td>
<td align="left">John Boozman</td>
<td align="left">R</td>
<td align="left">AR</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">SenJohnBarrasso</td>
<td align="left">John Barrasso</td>
<td align="left">R</td>
<td align="left">WY</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">## 3 greatest outdegree
twitter.senator[out.order[<span class="dv">1</span>:<span class="dv">3</span>], ]</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">screen_name</th>
<th align="left">name</th>
<th align="left">party</th>
<th align="left">state</th>
<th align="right">indegree</th>
<th align="right">outdegree</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">2</td>
<td align="left">RoyBlunt</td>
<td align="left">Roy Blunt</td>
<td align="left">R</td>
<td align="left">MO</td>
<td align="right">1</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">SenAlexander</td>
<td align="left">Lamar Alexander</td>
<td align="left">R</td>
<td align="left">TN</td>
<td align="right">1</td>
<td align="right">38</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">SenatorBoxer</td>
<td align="left">Barbara Boxer</td>
<td align="left">D</td>
<td align="left">CA</td>
<td align="right">0</td>
<td align="right">7</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(twitter.senator)
## color: Democrats = `blue', Republicans = `red', Independent = `black'
col &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">"red"</span>, n)
col[twitter.senator$party ==<span class="st"> "D"</span>] &lt;-<span class="st"> "blue"</span>
col[twitter.senator$party ==<span class="st"> "I"</span>] &lt;-<span class="st"> "black"</span>

## pch: Democrats = circle, Republicans = diamond, Independent = cross
pch &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">16</span>, n)
pch[twitter.senator$party ==<span class="st"> "D"</span>] &lt;-<span class="st"> </span><span class="dv">17</span>
pch[twitter.senator$party ==<span class="st"> "I"</span>] &lt;-<span class="st"> </span><span class="dv">4</span>

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
## plot for comparing two closeness measures (incoming vs. outgoing)
<span class="kw">plot</span>(<span class="kw">closeness</span>(twitter.adj, <span class="dt">mode =</span> <span class="st">"in"</span>),
     <span class="kw">closeness</span>(twitter.adj, <span class="dt">mode =</span> <span class="st">"out"</span>), <span class="dt">pch =</span> pch, <span class="dt">col =</span> col,
     <span class="dt">main =</span> <span class="st">"Closeness"</span>, <span class="dt">xlab =</span> <span class="st">"Incoming path"</span>, <span class="dt">ylab =</span> <span class="st">"Outgoing path"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">## plot for comparing directed and undirected betweenness
<span class="kw">plot</span>(<span class="kw">betweenness</span>(twitter.adj, <span class="dt">directed =</span> <span class="ot">TRUE</span>),
     <span class="kw">betweenness</span>(twitter.adj, <span class="dt">directed =</span> <span class="ot">FALSE</span>), <span class="dt">pch =</span> pch, <span class="dt">col =</span> col,
     <span class="dt">main =</span> <span class="st">"Betweenness"</span>, <span class="dt">xlab =</span> <span class="st">"Directed"</span>, <span class="dt">ylab =</span> <span class="st">"Undirected"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-9-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">twitter.senator$pagerank &lt;-<span class="st"> </span><span class="kw">page.rank</span>(twitter.adj)$vector

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
## `col' parameter is defined earlier
<span class="kw">plot</span>(twitter.adj, <span class="dt">vertex.size =</span> twitter.senator$pagerank *<span class="st"> </span><span class="dv">1000</span>,
     <span class="dt">vertex.color =</span> col, <span class="dt">vertex.label =</span> <span class="ot">NA</span>,
     <span class="dt">edge.arrow.size =</span> <span class="fl">0.1</span>, <span class="dt">edge.width =</span> <span class="fl">0.5</span>)

PageRank &lt;-<span class="st"> </span>function(n, A, d, pr) { <span class="co"># function takes 4 inputs</span>
    deg &lt;-<span class="st"> </span><span class="kw">degree</span>(A, <span class="dt">mode =</span> <span class="st">"out"</span>) <span class="co"># outdegree calculation</span>
    for (j in <span class="dv">1</span>:n) {
        pr[j] &lt;-<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>d) /<span class="st"> </span>n +<span class="st">  </span>d *<span class="st"> </span><span class="kw">sum</span>(A[ ,j] *<span class="st"> </span>pr /<span class="st"> </span>deg)
    }
    <span class="kw">return</span>(pr)
}

nodes &lt;-<span class="st"> </span><span class="dv">4</span>

## adjacency matrix with arbitrary values
adj &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),
              <span class="dt">ncol =</span> nodes, <span class="dt">nrow =</span> nodes, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
adj</code></pre>
<table class="table"><tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody></table>
<pre class="sourceCode r"><code class="sourceCode r">adj &lt;-<span class="st"> </span><span class="kw">graph.adjacency</span>(adj)  <span class="co"># turn it into an igraph object</span>

d &lt;-<span class="st"> </span><span class="fl">0.85</span>  <span class="co"># typical choice of constant</span>
pr &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span> /<span class="st"> </span>nodes, nodes) <span class="co"># starting values</span>

## maximum absolute difference; use a value greater than threshold
diff &lt;-<span class="st"> </span><span class="dv">100</span>

## while loop with 0.001 being the threshold
while (diff &gt;<span class="st"> </span><span class="fl">0.001</span>) {
    pr.pre &lt;-<span class="st"> </span>pr <span class="co"># save the previous iteration</span>
    pr &lt;-<span class="st"> </span><span class="kw">PageRank</span>(<span class="dt">n =</span> nodes, <span class="dt">A =</span> adj, <span class="dt">d =</span> d, <span class="dt">pr =</span> pr)
    diff &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(pr -<span class="st"> </span>pr.pre))
}</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-9-3.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">pr</code></pre>
<pre><code>## [1] 0.2213090 0.4316623 0.2209565 0.1315563</code></pre>
</div>
</div>
<div id="section-5-3-spatial-data" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-5-3-spatial-data" class="anchor"> </a></body></html>Section 5.3: Spatial Data</h2>
<div id="section-5-3-1-the-1854-cholera-outbreak-in-action" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-3-1-the-1854-cholera-outbreak-in-action" class="anchor"> </a></body></html>Section 5.3.1: The 1854 Cholera Outbreak in Action</h3>
</div>
<div id="section-5-3-2-spatial-data-in-r" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-3-2-spatial-data-in-r" class="anchor"> </a></body></html>Section 5.3.2: Spatial Data in R</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maps)
<span class="kw">data</span>(us.cities)
<span class="kw">head</span>(us.cities)</code></pre>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">country.etc</th>
<th align="right">pop</th>
<th align="right">lat</th>
<th align="right">long</th>
<th align="right">capital</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Abilene TX</td>
<td align="left">TX</td>
<td align="right">113888</td>
<td align="right">32.45</td>
<td align="right">-99.74</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Akron OH</td>
<td align="left">OH</td>
<td align="right">206634</td>
<td align="right">41.08</td>
<td align="right">-81.52</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Alameda CA</td>
<td align="left">CA</td>
<td align="right">70069</td>
<td align="right">37.77</td>
<td align="right">-122.26</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Albany GA</td>
<td align="left">GA</td>
<td align="right">75510</td>
<td align="right">31.58</td>
<td align="right">-84.18</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">Albany NY</td>
<td align="left">NY</td>
<td align="right">93576</td>
<td align="right">42.67</td>
<td align="right">-73.80</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">Albany OR</td>
<td align="left">OR</td>
<td align="right">45535</td>
<td align="right">44.62</td>
<td align="right">-123.09</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)

<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"usa"</span>)
capitals &lt;-<span class="st"> </span><span class="kw">subset</span>(us.cities, capital ==<span class="st"> </span><span class="dv">2</span>) <span class="co"># subset state capitals</span>

## add points proportional to population using latitude and longitude
<span class="kw">points</span>(<span class="dt">x =</span> capitals$long, <span class="dt">y =</span> capitals$lat,
       <span class="dt">cex =</span> capitals$pop /<span class="st"> </span><span class="dv">500000</span>, <span class="dt">pch =</span> <span class="dv">19</span>)
<span class="kw">title</span>(<span class="st">"US state capitals"</span>) <span class="co"># add a title</span></code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>, <span class="dt">regions =</span> <span class="st">"California"</span>)

cal.cities &lt;-<span class="st"> </span><span class="kw">subset</span>(us.cities, <span class="dt">subset =</span> (country.etc ==<span class="st"> "CA"</span>))
sind &lt;-<span class="st"> </span><span class="kw">order</span>(cal.cities$pop, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>) <span class="co"># order by population</span>
top7 &lt;-<span class="st"> </span>sind[<span class="dv">1</span>:<span class="dv">7</span>] <span class="co"># seven cities with largest population</span>

<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>, <span class="dt">regions =</span> <span class="st">"California"</span>)

<span class="kw">points</span>(<span class="dt">x =</span> cal.cities$long[top7], <span class="dt">y =</span> cal.cities$lat[top7], <span class="dt">pch =</span> <span class="dv">19</span>)

## add a constant to latitude to avoid overlapping with circles
<span class="kw">text</span>(<span class="dt">x =</span> cal.cities$long[top7] +<span class="st"> </span><span class="fl">2.25</span>, <span class="dt">y =</span> cal.cities$lat[top7],
     <span class="dt">label =</span> cal.cities$name[top7])
<span class="kw">title</span>(<span class="st">"Largest cities of California"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-10-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">usa &lt;-<span class="st"> </span><span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"usa"</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>) <span class="co"># save map</span>
<span class="kw">names</span>(usa)  <span class="co"># list elements</span></code></pre>
<pre><code>## [1] "x"     "y"     "range" "names"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(usa$x)</code></pre>
<pre><code>## [1] 7252</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">cbind</span>(usa$x, usa$y)) <span class="co"># first five coordinates of a polygon</span></code></pre>
<table class="table"><tbody>
<tr class="odd">
<td align="right">-101.4078</td>
<td align="right">29.74224</td>
</tr>
<tr class="even">
<td align="right">-101.3906</td>
<td align="right">29.74224</td>
</tr>
<tr class="odd">
<td align="right">-101.3620</td>
<td align="right">29.65056</td>
</tr>
<tr class="even">
<td align="right">-101.3505</td>
<td align="right">29.63911</td>
</tr>
<tr class="odd">
<td align="right">-101.3219</td>
<td align="right">29.63338</td>
</tr>
<tr class="even">
<td align="right">-101.3047</td>
<td align="right">29.64484</td>
</tr>
</tbody></table>
</div>
<div id="section-5-3-3-colors-in-r" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-3-3-colors-in-r" class="anchor"> </a></body></html>Section 5.3.3: Colors in R</h3>
<pre class="sourceCode r"><code class="sourceCode r">allcolors &lt;-<span class="st"> </span><span class="kw">colors</span>()

<span class="kw">head</span>(allcolors)   <span class="co"># some colors</span></code></pre>
<pre><code>## [1] "white"         "aliceblue"     "antiquewhite"  "antiquewhite1"
## [5] "antiquewhite2" "antiquewhite3"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(allcolors) <span class="co"># number of color names</span></code></pre>
<pre><code>## [1] 657</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">red &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">1</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">0</span>) <span class="co"># red</span>
green &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">1</span>, <span class="dt">blue =</span> <span class="dv">0</span>) <span class="co"># green</span>
blue &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">1</span>) <span class="co"># blue</span>
<span class="kw">c</span>(red, green, blue) <span class="co"># results</span></code></pre>
<pre><code>## [1] "#FF0000" "#00FF00" "#0000FF"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">black &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">0</span>) <span class="co"># black</span>
white &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">1</span>, <span class="dt">green =</span> <span class="dv">1</span>, <span class="dt">blue =</span> <span class="dv">1</span>) <span class="co"># white</span>
<span class="kw">c</span>(black, white) <span class="co"># results</span></code></pre>
<pre><code>## [1] "#000000" "#FFFFFF"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dt">green =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">blue =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>))</code></pre>
<pre><code>## [1] "#800080" "#FFFF00"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## semi-transparent blue
blue.trans &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)

## semi-transparent black
black.trans &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)

## completely colored dots; difficult to distinguish
<span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>),
     <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> black)
<span class="kw">points</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="fl">3.2</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, <span class="dt">col =</span> blue)

## semi-transparent; easy to distinguish
<span class="kw">points</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">2.2</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, <span class="dt">col =</span> black.trans)
<span class="kw">points</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="fl">4.2</span>), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">5</span>, <span class="dt">col =</span> blue.trans)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="section-5-3-4-us-presidential-elections" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-3-4-us-presidential-elections" class="anchor"> </a></body></html>Section 5.3.4: US Presidential Elections</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"pres08"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)
## two-party vote share
pres08$Dem &lt;-<span class="st"> </span>pres08$Obama /<span class="st"> </span>(pres08$Obama +<span class="st"> </span>pres08$McCain)
pres08$Rep &lt;-<span class="st"> </span>pres08$McCain /<span class="st"> </span>(pres08$Obama +<span class="st"> </span>pres08$McCain)

## color for California
cal.color &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> pres08$Rep[pres08$state ==<span class="st"> "CA"</span>],
                 <span class="dt">blue =</span> pres08$Dem[pres08$state ==<span class="st"> "CA"</span>],
                 <span class="dt">green =</span> <span class="dv">0</span>)

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
## California as a blue state
<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>, <span class="dt">regions =</span> <span class="st">"California"</span>, <span class="dt">col =</span> <span class="st">"blue"</span>,
    <span class="dt">fill =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">## California as a purple state
<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>, <span class="dt">regions =</span> <span class="st">"California"</span>, <span class="dt">col =</span> cal.color,
    <span class="dt">fill =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-12-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
## America as red and blue states
<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>) <span class="co"># create a map</span>
for (i in <span class="dv">1</span>:<span class="kw">nrow</span>(pres08)) {
    if ((pres08$state[i] !=<span class="st"> "HI"</span>) &amp;<span class="st"> </span>(pres08$state[i] !=<span class="st"> "AK"</span>) &amp;
<span class="st">        </span>(pres08$state[i] !=<span class="st"> "DC"</span>)) {
        <span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>, <span class="dt">regions =</span> pres08$state.name[i],
            <span class="dt">col =</span> <span class="kw">ifelse</span>(pres08$Rep[i] &gt;<span class="st"> </span>pres08$Dem[i], <span class="st">"red"</span>, <span class="st">"blue"</span>),
            <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
    }
}</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-12-3.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">## America as purple states
<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>) <span class="co"># create a map</span>
for (i in <span class="dv">1</span>:<span class="kw">nrow</span>(pres08)) {
    if ((pres08$state[i] !=<span class="st"> "HI"</span>) &amp;<span class="st"> </span>(pres08$state[i] !=<span class="st"> "AK"</span>) &amp;
<span class="st">        </span>(pres08$state[i] !=<span class="st"> "DC"</span>)) {
        <span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>, <span class="dt">regions =</span> pres08$state.name[i],
            <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dt">red =</span> pres08$Rep[i], <span class="dt">blue =</span> pres08$Dem[i],
                <span class="dt">green =</span> <span class="dv">0</span>), <span class="dt">fill =</span> <span class="ot">TRUE</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)
    }
}</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-12-4.png" width="672"></p>
</div>
<div id="section-5-3-5-expansion-of-walmart" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-3-5-expansion-of-walmart" class="anchor"> </a></body></html>Section 5.3.5: Expansion of Walmart</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"walmart"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)

## red = WalMartStore, green = SuperCenter, blue = DistributionCenter
walmart$storecolors &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># create an empty vector</span>

walmart$storecolors[walmart$type ==<span class="st"> "Wal-MartStore"</span>] &lt;-
<span class="st">    </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">1</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">1</span>/<span class="dv">3</span>)
walmart$storecolors[walmart$type ==<span class="st"> "SuperCenter"</span>] &lt;-
<span class="st">    </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">1</span>, <span class="dt">blue =</span> <span class="dv">0</span>, <span class="dt">alpha =</span> <span class="dv">1</span>/<span class="dv">3</span>)
walmart$storecolors[walmart$type ==<span class="st"> "DistributionCenter"</span>] &lt;-
<span class="st">    </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">0</span>, <span class="dt">blue =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="dv">1</span>/<span class="dv">3</span>)

## larger circles for DistributionCenter
walmart$storesize &lt;-<span class="st"> </span><span class="kw">ifelse</span>(walmart$type ==<span class="st"> "DistributionCenter"</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)
## map with legend
<span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>)

<span class="kw">points</span>(walmart$long, walmart$lat, <span class="dt">col =</span> walmart$storecolors,
       <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> walmart$storesize)

<span class="kw">legend</span>(<span class="dt">x =</span> -<span class="dv">120</span>, <span class="dt">y =</span> <span class="dv">32</span>, <span class="dt">bty =</span> <span class="st">"n"</span>,
       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">"Wal-Mart"</span>, <span class="st">"Supercenter"</span>, <span class="st">"Distrib. Center"</span>),
       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="co"># solid circles</span>
       <span class="dt">pt.cex =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)) <span class="co"># size of circles</span></code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="section-5-3-6-animation-in-r" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-5-3-6-animation-in-r" class="anchor"> </a></body></html>Section 5.3.6: Animation in R</h3>
<pre class="sourceCode r"><code class="sourceCode r">walmart.map &lt;-<span class="st"> </span>function(data, date) {
    walmart &lt;-<span class="st"> </span><span class="kw">subset</span>(data, <span class="dt">subset =</span> (opendate &lt;=<span class="st"> </span>date))
    <span class="kw">map</span>(<span class="dt">database =</span> <span class="st">"state"</span>)
    <span class="kw">points</span>(walmart$long, walmart$lat, <span class="dt">col =</span> walmart$storecolors,
           <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> walmart$storesize)
}

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.25</span>)

walmart$opendate &lt;-<span class="st"> </span><span class="kw">as.Date</span>(walmart$opendate)

<span class="kw">walmart.map</span>(walmart, <span class="kw">as.Date</span>(<span class="st">"1974-12-31"</span>))
<span class="kw">title</span>(<span class="st">"1975"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">walmart.map</span>(walmart, <span class="kw">as.Date</span>(<span class="st">"1984-12-31"</span>))
<span class="kw">title</span>(<span class="st">"1985"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-14-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">walmart.map</span>(walmart, <span class="kw">as.Date</span>(<span class="st">"1994-12-31"</span>))
<span class="kw">title</span>(<span class="st">"1995"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-14-3.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">walmart.map</span>(walmart, <span class="kw">as.Date</span>(<span class="st">"2004-12-31"</span>))
<span class="kw">title</span>(<span class="st">"2005"</span>)</code></pre>
<p><img src="discovery_files/figure-html/unnamed-chunk-14-4.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">25</span> <span class="co"># number of maps to animate</span>
dates &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(walmart$opendate),
             <span class="dt">to =</span> <span class="kw">max</span>(walmart$opendate), <span class="dt">length.out =</span> n)
## library("animation")
## saveHTML({
##     for (i in 1:length(dates)) {
##         walmart.map(walmart, dates[i])
##         title(dates[i])
##     }
## }, title = "Expansion of Walmart", htmlfile = "walmart.html",
##          outdir = getwd(), autobrowse = FALSE)</code></pre>
</div>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#summary" class="anchor"> </a></body></html>5.4: Summary</h2>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#chapter-5-discovery">Chapter 5: Discovery</a><ul class="nav nav-pills nav-stacked">
<li><a href="#section-5.1-textual-data">Section 5.1: Textual Data</a></li>
      <li><a href="#section-5.2-network-data">Section 5.2: Network Data</a></li>
      <li><a href="#section-5.3-spatial-data">Section 5.3: Spatial Data</a></li>
      <li><a href="#summary">5.4: Summary</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jeffey Arnold, Kosuke Imai, Tyler Simko.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
